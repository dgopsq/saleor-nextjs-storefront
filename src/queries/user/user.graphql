fragment GenericAddress on Address {
  id
  firstName
  lastName
  companyName
  streetAddress1
  streetAddress2
  city
  cityArea
  postalCode
  country {
    code
    country
  }
  countryArea
  phone
  isDefaultShippingAddress
  isDefaultBillingAddress
}

fragment GenericUser on User {
  id
  email
  firstName
  lastName
  isActive
  checkouts(first: 1) {
    edges {
      node {
        token
      }
    }
  }
  addresses {
    ...GenericAddress
  }
  defaultShippingAddress {
    ...GenericAddress
  }
  defaultBillingAddress {
    ...GenericAddress
  }
}

query GetMe {
  me {
    ...GenericUser
  }
}

mutation CreateAccount($account: AccountRegisterInput!) {
  accountRegister(input: $account) {
    requiresConfirmation
    errors {
      code
      message
      field
    }
  }
}

mutation CreateToken($email: String!, $password: String!) {
  tokenCreate(email: $email, password: $password) {
    token
    refreshToken
    csrfToken
    user {
      ...GenericUser
    }
    errors {
      code
      message
      field
    }
  }
}

mutation UserUpdate($userInfo: AccountInput!) {
  accountUpdate(input: $userInfo) {
    user {
      ...GenericUser
    }
    errors {
      code
      message
      field
    }
  }
}

mutation UserPasswordChange($oldPassword: String!, $newPassword: String!) {
  passwordChange(oldPassword: $oldPassword, newPassword: $newPassword) {
    user {
      ...GenericUser
    }
    errors {
      code
      message
      field
    }
  }
}

mutation UserEmailChange(
  $newEmail: String!
  $password: String!
  $redirectUrl: String!
) {
  requestEmailChange(
    newEmail: $newEmail
    password: $password
    redirectUrl: $redirectUrl
  ) {
    errors {
      code
      message
      field
    }
    user {
      ...GenericUser
    }
  }
}

mutation UserConfirmEmailChange($token: String!) {
  confirmEmailChange(token: $token) {
    errors {
      code
      message
      field
    }
    user {
      ...GenericUser
    }
  }
}

mutation UserCreateAddress($input: AddressInput!, $type: AddressTypeEnum!) {
  accountAddressCreate(input: $input, type: $type) {
    errors {
      code
      message
      field
    }
    user {
      ...GenericUser
    }
  }
}

mutation UserUpdateAddress($id: ID!, $input: AddressInput!) {
  accountAddressUpdate(id: $id, input: $input) {
    errors {
      code
      message
      field
    }
    user {
      ...GenericUser
    }
  }
}

mutation UserSetDefaultAddress(
  $addressId: ID!
  $addressType: AddressTypeEnum!
) {
  accountSetDefaultAddress(id: $addressId, type: $addressType) {
    errors {
      code
      message
      field
    }
    user {
      ...GenericUser
    }
  }
}
