fragment GenericProductVariant on ProductVariant {
  id
  sku
  quantityAvailable
  quantityLimitPerCustomer
  name
  media {
    id
    url
    sortOrder
    alt
  }
  pricing {
    onSale
    discount {
      gross {
        amount
        currency
      }
    }
    price {
      gross {
        amount
        currency
      }
    }
  }
  attributes {
    attribute {
      id
      inputType
      name
    }
    values {
      id
      name
    }
  }
}

fragment DetailedProduct on Product {
  description
  defaultVariant {
    ...GenericProductVariant
  }
  variants {
    ...GenericProductVariant
  }
  attributes {
    attribute {
      id
      inputType
      name
    }
    values {
      id
      name
    }
  }
}

fragment PreviewProduct on Product {
  id
  name
  slug
  pricing {
    priceRange {
      start {
        gross {
          amount
          currency
        }
      }

      stop {
        gross {
          amount
          currency
        }
      }
    }

    discount {
      gross {
        amount
        currency
      }
    }
  }
  media {
    id
    url
    sortOrder
    alt
  }
}

query GetProducts(
  $first: Int!
  $after: String
  $filters: ProductFilterInput
  $sortBy: ProductOrder
) {
  products(first: $first, after: $after, filter: $filters, sortBy: $sortBy) {
    edges {
      node {
        ...PreviewProduct
      }
      cursor
    }
    pageInfo {
      hasNextPage
      startCursor
      endCursor
    }
  }
}

query GetProduct($slug: String!) {
  product(slug: $slug) {
    ...PreviewProduct
    ...DetailedProduct
  }
}
